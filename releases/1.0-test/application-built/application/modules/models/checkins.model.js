define(["google","models/app.model"],function(google){var coords=App.get("geocoords"),geocoords=App.get("geocoords"),checkIns=Backbone.Model.extend({defaults:{limit:100,search_for:"",source:"appbg",activity_order:"date",sort_order:"desc",act:"all",type:"all",circumference:"5",lat:geocoords.latitude,lon:geocoords.longitude},renderListingResponse:function(settings){var icon,iconSize,template,actionTitle;$.mobile.showPageLoadingMsg(),$.ajax({url:"/json_api",data:CheckIns.attributes,type:"get",dataType:"json",success:function(response){$("#checkInsListings").empty(),$.isEmptyObject(response)||($.each(response,function(key,value){if(typeof value=="object"){console.log(value),iconSize=[30,35],value.type=="bz_activity"&&(actionTitle=$(value.action).text(),template=_.template("<li><%=thumbnail%><h3><%=title%></h3><p><%=content%><br/>Approximately <%=distance%> mi near you.</p></li>"),template=template({thumbnail:value.author_html,title:actionTitle,content:value.content,distance:value.distance}),icon=""),value.type=="foursquare"&&(template=_.template('<li><img src="<%=thumbnail%>" /><h3><%=title%><small> <%=time%></small></h3><p class="twitterText"><%=content%><br/><small> Approximately <%=distance%> mi near you.</small></p></li>'),template=template({title:value.venue,thumbnail:value.category_icon_url,content:value.text,distance:value.distance,time:value.time_ago}),icon="/wp-content/themes/bazaar/mobile/public/images/foursquare-marker.png"),value.type=="twitter"&&(template=_.template('<li><img src="<%=thumbnail%>" /><h3><%=name%> tweeted <small><%=time%></small></h3><p class="twitterText"><%=content%><br/><small>Approximately <%=distance%> mi near you</small></p></li>'),template=template({name:value.user.name,thumbnail:value.user.profile_image,content:value.text,distance:value.distance,time:value.time_ago}),icon="/wp-content/themes/bazaar/mobile/public/images/twitter-marker.png");if(value.type=="instagram"){var actionTitle=value.user.name+" uploaded a new picture in instagram";template=_.template('<li><img src="<%=thumbnail%>" /><h3><%=title%><small>&nbsp; <%=time%></small></h3><p><small>Approximately <%=distance%> mi near you</small><br/></p><p><img src="<%=image%>" /><br/><%=content%></p></li>'),template=template({thumbnail:value.user.profile_picture,title:actionTitle,content:value.text,image:value.images.thumbnail,distance:value.distance,time:value.time_ago}),icon="/wp-content/themes/bazaar/mobile/public/images/instagram-marker.png"}App.addMarker(parseFloat(value.location.latitude),parseFloat(value.location.longitude),value.title,icon,iconSize),$("#checkInsListings").append(template)}}),$("#checkInsListings").listview("refresh"),$("#showmoreBtn").css("display","block")),$.mobile.hidePageLoadingMsg()}})}});return window.CheckIns=new checkIns,CheckIns})